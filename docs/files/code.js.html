<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Code.js - Mira-Editor</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="Mira-Editor" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AbstractElement.html">AbstractElement</a></li>
                                <li><a href="../classes/AbstractInterface.html">AbstractInterface</a></li>
                                <li><a href="../classes/BootstrapNavigation.html">BootstrapNavigation</a></li>
                                <li><a href="../classes/BootstrapNavigationList.html">BootstrapNavigationList</a></li>
                                <li><a href="../classes/BootstrapNavigationListItem.html">BootstrapNavigationListItem</a></li>
                                <li><a href="../classes/Button.html">Button</a></li>
                                <li><a href="../classes/Carousel.html">Carousel</a></li>
                                <li><a href="../classes/CarouselItem.html">CarouselItem</a></li>
                                <li><a href="../classes/Code.html">Code</a></li>
                                <li><a href="../classes/ConcreteInterface.html">ConcreteInterface</a></li>
                                <li><a href="../classes/Div.html">Div</a></li>
                                <li><a href="../classes/Formulario.html">Formulario</a></li>
                                <li><a href="../classes/Header.html">Header</a></li>
                                <li><a href="../classes/HTMLElement.html">HTMLElement</a></li>
                                <li><a href="../classes/ImageHtml.html">ImageHtml</a></li>
                                <li><a href="../classes/InputOption.html">InputOption</a></li>
                                <li><a href="../classes/InputRadioCheck.html">InputRadioCheck</a></li>
                                <li><a href="../classes/InputSelect.html">InputSelect</a></li>
                                <li><a href="../classes/InputText.html">InputText</a></li>
                                <li><a href="../classes/InputTextarea.html">InputTextarea</a></li>
                                <li><a href="../classes/Label.html">Label</a></li>
                                <li><a href="../classes/Link.html">Link</a></li>
                                <li><a href="../classes/List.html">List</a></li>
                                <li><a href="../classes/ListItem.html">ListItem</a></li>
                                <li><a href="../classes/Paragraph.html">Paragraph</a></li>
                                <li><a href="../classes/Preview.html">Preview</a></li>
                                <li><a href="../classes/Project.html">Project</a></li>
                                <li><a href="../classes/RenderElements.html">RenderElements</a></li>
                                <li><a href="../classes/SimpleHtml.html">SimpleHtml</a></li>
                                <li><a href="../classes/Span.html">Span</a></li>
                                <li><a href="../classes/Tree.html">Tree</a></li>
                                <li><a href="../classes/Tree.initModalAndEvents.html">Tree.initModalAndEvents</a></li>
                                <li><a href="../classes/UIEvents.html">UIEvents</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: Code.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Classe responsável pelos métodos de gereção e exibição do código da interface abstrata e concreta
 *
 * @class Code
 * @constructor
 */
var Code = function () {
    &quot;use strict&quot;;
    
    /**
    * @property times Modelo pré definido para execução dos testes.
    * @type {Object}
    */
    var times = 
    [
        {
            text: &#x27;container&#x27;, 
            nodes: [
                {
                    text: &#x27;content-panel&#x27;,
                    nodes: [
                        {
                        text: &#x27;panel&#x27;, 
                        nodes: [
                            {text: &#x27;panel-title&#x27;},
                            {
                                text: &#x27;panel-body&#x27;,
                                nodes: [
                                    {text: &#x27;label-state&#x27;},
                                    {text: &#x27;value-state&#x27;},
                                    {text: &#x27;label-points&#x27;},
                                    {text: &#x27;value-points&#x27;},
                                ]
                            }
                        ]
                    }
                    ]
                }
            ]
        }
    ];

    /**
    * @property resultAbstractInterface Interface Concreta para teste.
    * @type {Object}
    */
    var resultAbstractInterface = 
    {
        name: &#x27;landing&#x27;,
        widgets: 
        [
            {
                name: &#x27;container&#x27;,
                datasource: &#x27;http://mira.tecweb.inf.puc-rio.br/api/futebol&#x27;,
                children: 
                [
                    {
                        name: &#x27;content-panel&#x27;,
                        children: [
                            {
                                name: &#x27;panel&#x27;,
                                children: 
                                [
                                    {name: &#x27;panel-title&#x27;, bind: &#x27;$data.nome&#x27;},
                                    {
                                        name: &#x27;panel-body&#x27;, 
                                        children:
                                        [
                                            {name: &#x27;label-state&#x27;},
                                            {name: &#x27;value-state&#x27;, bind: &#x27;$data.estado&#x27;},
                                            {name: &#x27;label-points&#x27;},
                                            {name: &#x27;value-points&#x27;, bind: &#x27;$data.ponto&#x27;}
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ]
    };
    

    /**
    * @property resultConcreteInterface Interface Concreta para teste.
    * @type {Object}
    */
    var resultConcreteInterface = 
    {
        name: &#x27;landing&#x27;,
        maps: 
        [
            {name: &#x27;container&#x27;, class: &#x27;container&#x27;},
            {name: &#x27;content-panel&#x27;, class: &#x27;col-md-4&#x27;},
            {name: &#x27;panel&#x27;, class: &#x27;panel panel-primary&#x27;},
            {name: &#x27;panel-title&#x27;, class: &#x27;panel-heading&#x27;, value: &#x27;$bind&#x27;},
            {name: &#x27;panel-body&#x27;, class: &#x27;panel-body&#x27;},
            {name: &#x27;label-state&#x27;, tag: &#x27;label&#x27;, value: &quot;Estado: &quot;},
            {name: &#x27;value-state&#x27;, tag: &#x27;p&#x27;, value: &#x27;$bind&#x27;},
            {name: &#x27;label-points&#x27;, tag: &#x27;label&#x27;, value: &quot;Pontos: &quot;},
            {name: &#x27;value-points&#x27;, tag: &#x27;p&#x27;, value: &#x27;$bind&#x27;},
        ]
    };
    
    
    /**
     * Método responsável por trocar todas as ocorrências de uma determinada expressão por outra.
     * @param {string} de Expressão a ser trocada.
     * @param {string} para Nova expressão a ser inserida
     * @return Nova string
     */
    String.prototype.replaceAll = function(de, para){
        var str = this;
        var pos = str.indexOf(de);
        while (pos &gt; -1){
            str = str.replace(de, para);
            pos = str.indexOf(de);
        }
        return (str);
    };

    
    /**
     * Método responsável por remover as aspas duplas de determinados termos.
     * @author João Victor Magela.
     * @method cleanString
     * @param {string} string
     * @return A string sem termos com aspas duplas.
     */
    var _cleanString = function (string) {
        return string.replaceAll(&#x27;\&quot;name\&quot;:&#x27;, &#x27;name:&#x27;)
        .replaceAll(&#x27;\&quot;widget\&quot;:&#x27;, &#x27;widget:&#x27;)
        .replaceAll(&#x27;\&quot;widgets\&quot;:&#x27;, &#x27;widgets:&#x27;)
        .replaceAll(&#x27;\&quot;datasource\&quot;:&#x27;, &#x27;datasource:&#x27;)
        .replaceAll(&#x27;\&quot;children\&quot;:&#x27;, &#x27;children:&#x27;)
        .replaceAll(&#x27;\&quot;head\&quot;:&#x27;, &#x27;head:&#x27;)
        .replaceAll(&#x27;\&quot;maps\&quot;:&#x27;, &#x27;maps:&#x27;)
        .replaceAll(&#x27;\&quot;class\&quot;:&#x27;, &#x27;class:&#x27;)
        .replaceAll(&#x27;\&quot;value\&quot;:&#x27;, &#x27;value:&#x27;)
        .replaceAll(&#x27;\&quot;href\&quot;:&#x27;, &#x27;href:&#x27;)
        .replaceAll(&#x27;\&quot;parse\&quot;:&#x27;, &#x27;parse:&#x27;)
        .replaceAll(&#x27;\&quot;tag\&quot;:&#x27;, &#x27;tag:&#x27;)
        .replaceAll(&#x27;\&quot;src\&quot;:&#x27;, &#x27;src:&#x27;)
        .replaceAll(&#x27;\&quot;alt\&quot;:&#x27;, &#x27;alt:&#x27;)
        .replaceAll(&#x27;\&quot;bind\&quot;:&#x27;, &#x27;bind:&#x27;)
        .replaceAll(&#x27;\\\&quot;&#x27;, &#x27;\&#x27;&#x27;);
    };

    /**
     * Método responsável por gerar uma interface abstrata para testes.
     * @author João Victor Magela.
     * @method initAbstract
     * 
     */
    var initAbstract = function(){
        var _processAjax = function(){
            var panelTitle = globalTree.nodes[3];
            panelTitle.bind = &#x27;$data.nome&#x27;;

            var valueState = globalTree.nodes[6];
            valueState.bind = &#x27;$data.estado&#x27;;

            var valuePoints = globalTree.nodes[8];
            valuePoints.bind = &#x27;$data.ponto&#x27;;

            globalTree.tree = globalTree.refreshTree(globalTree.tree, panelTitle);
            globalTree.tree = globalTree.refreshTree(globalTree.tree, valueState);
            globalTree.tree = globalTree.refreshTree(globalTree.tree, valuePoints);
        }


        var node = globalTree.nodes[0];
        node.datasource = &#x27;http://mira.tecweb.inf.puc-rio.br/api/futebol&#x27;;

        $.ajax({
            url: node.datasource,
            type: &#x27;GET&#x27;,
            success: function(data){
                data = $.parseJSON($(data.responseText)[0].data);
                node = globalTree.setDataToChildren(node, data);
                globalTree.tree = globalTree.refreshTree(globalTree.tree, node);
                _processAjax();
            }
        });
    };

    /**
     * Método responsável por gerar uma interface concreta para testes.
     * @author João Victor Magela.
     * @method initConcrete
     * 
     */
    var initConcrete = function(){
        concreteInterfaceObj.concreteInterfaceItems[0].class = &#x27;container&#x27;;
        concreteInterfaceObj.concreteInterfaceItems[1].class = &#x27;col-md-4&#x27;;
        concreteInterfaceObj.concreteInterfaceItems[2].class = &#x27;panel panel-primary&#x27;;
        concreteInterfaceObj.concreteInterfaceItems[3] = new Div(globalTree.nodes[3]);
        concreteInterfaceObj.concreteInterfaceItems[3].class = &#x27;panel-heading&#x27;;

        concreteInterfaceObj.concreteInterfaceItems[4].class = &#x27;panel-body&#x27;;

        concreteInterfaceObj.concreteInterfaceItems[5] = new Label(globalTree.nodes[5]);
        concreteInterfaceObj.concreteInterfaceItems[5].value = &quot;Estado: &quot;;

        concreteInterfaceObj.concreteInterfaceItems[6] = new Paragraph(globalTree.nodes[6]);

        concreteInterfaceObj.concreteInterfaceItems[7] = new Label(globalTree.nodes[7]);
        concreteInterfaceObj.concreteInterfaceItems[7].value = &quot;Pontos: &quot;;

        concreteInterfaceObj.concreteInterfaceItems[8] = new Paragraph(globalTree.nodes[8]);
    }

    /**
     * Método responsável por executar os testes
     * @author João Victor Magela.
     * @method tests
     * @static 
     */
    var tests = function(){
        concreteInterfaceObj.concreteInterfaceItems = [];

        // Inicia com o modelo pre-definido
        Project.initCustom(times); 
        QUnit.module(&quot;Código Gerado&quot;);

        /**
        * Teste: Gerar código das interfaces
        * @author João Victor Magela
        *
        * Verificar se a geração do código para a Interface Concreta e Abstrata está de acordo com o esperado.
        * Passos:
        *1 - Gerar o código das Interfaces.
        *2 - Verificar se está de acordo com o esperado.
        */
        QUnit.test(&quot;Gerar código das interfaces&quot;, function(assert){
            assert.expect(4);
            var done = assert.async();
            initAbstract();
            setTimeout(function() {
                initConcrete();
                
                //Passo 1
                globalTree.$element.empty().append(globalTree.$wrapper.empty());
                globalTree.buildTree(globalTree.tree, 0);
                globalTree.$element.trigger(&#x27;treeRender&#x27;, $.extend(true, {}, globalTree));

                //Passo 2
                //Verifica se a interface abstrata foi gerada corretamente
                var widgets1 = JSON.parse(stringify(abstractInterfaceObj.widgets, {maxLength: 80, indent: 2}));
                var widgets2 = JSON.parse(stringify(resultAbstractInterface.widgets, {maxLength: 80, indent: 2}));

                assert.equal(abstractInterfaceObj.name, resultAbstractInterface.name, &quot;Nome da Interface Abstrata está correta.&quot;);
                assert.ok(_.isEqual(widgets1, widgets2), &quot;Widgets Abstratos foram gerados corretamente.&quot;);    

                //Verifica se a interface concreta foi gerada corretamente
                var maps1 = JSON.parse(stringify(concreteInterfaceObj.maps, {maxLength: 80, indent: 2}));
                var maps2 = JSON.parse(stringify(resultConcreteInterface.maps, {maxLength: 80, indent: 2}));
                assert.equal(concreteInterfaceObj.name, resultConcreteInterface.name, &quot;Nome da Interface Concreta está correta.&quot;);
                assert.deepEqual(maps1, maps2, &quot;Mapeamento dos widgtes concretos foi feito corretamente.&quot;);    
                done();
            }, 800);
        });
    };

    return {
        /**
         * Método responsável por exibir em um modal do Twitter Bootstrap o código gerado.
         * @author João Victor Magela.
         * @method openModalCode
         * @static 
         */
        openModalCode: function () {
            $(&#x27;.btn-open-modal&#x27;).click(function(e) {
                var code = $(this).parents(&#x27;.panel&#x27;).find(&#x27;pre&#x27;).clone();
                
                $(&#x27;#modal-code&#x27;).find(&#x27;.modal-body&#x27;).html(code);
                $(&#x27;#modal-code&#x27;).modal(&#x27;show&#x27;);
            });
        },

        /**
         * Método responsável por exibir o código gerado da interface abstrata.
         * @author João Victor Magela.
         * @param {Object} data Dados com os widgets abstratos.
         * @method showAbstractInterfaceCode
         * @static 
         */
        showAbstractInterfaceCode: function(data) {
            $(&#x27;#abstract-code pre&#x27;).html(
                _cleanString(abstractInterfaceObj.generateAbstractInterface(data.abstractInterface))
            );
        },

        /**
         * Método responsável por exibir o código gerado da interface concreta.
         * @author João Victor Magela.
         * @method showConcreteInterfaceCode
         * @static 
         */
        showConcreteInterfaceCode: function() {
            $(&#x27;#concrete-code pre&#x27;).html(
                _cleanString(concreteInterfaceObj.generateConcreteInterface())
            );
        },

        tests: tests,
        times: times,
        initAbstract: initAbstract,
        initConcrete: initConcrete,
    };
}();
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
