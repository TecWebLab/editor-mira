<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>render-elements.js - Mira-Editor</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="Mira-Editor" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/AbstractElement.html">AbstractElement</a></li>
                                <li><a href="../classes/AbstractInterface.html">AbstractInterface</a></li>
                                <li><a href="../classes/BootstrapNavigation.html">BootstrapNavigation</a></li>
                                <li><a href="../classes/BootstrapNavigationList.html">BootstrapNavigationList</a></li>
                                <li><a href="../classes/BootstrapNavigationListItem.html">BootstrapNavigationListItem</a></li>
                                <li><a href="../classes/Button.html">Button</a></li>
                                <li><a href="../classes/Carousel.html">Carousel</a></li>
                                <li><a href="../classes/CarouselItem.html">CarouselItem</a></li>
                                <li><a href="../classes/Code.html">Code</a></li>
                                <li><a href="../classes/ConcreteInterface.html">ConcreteInterface</a></li>
                                <li><a href="../classes/Div.html">Div</a></li>
                                <li><a href="../classes/Formulario.html">Formulario</a></li>
                                <li><a href="../classes/Header.html">Header</a></li>
                                <li><a href="../classes/HTMLElement.html">HTMLElement</a></li>
                                <li><a href="../classes/ImageHtml.html">ImageHtml</a></li>
                                <li><a href="../classes/InputOption.html">InputOption</a></li>
                                <li><a href="../classes/InputRadioCheck.html">InputRadioCheck</a></li>
                                <li><a href="../classes/InputSelect.html">InputSelect</a></li>
                                <li><a href="../classes/InputText.html">InputText</a></li>
                                <li><a href="../classes/InputTextarea.html">InputTextarea</a></li>
                                <li><a href="../classes/Label.html">Label</a></li>
                                <li><a href="../classes/Link.html">Link</a></li>
                                <li><a href="../classes/List.html">List</a></li>
                                <li><a href="../classes/ListItem.html">ListItem</a></li>
                                <li><a href="../classes/Paragraph.html">Paragraph</a></li>
                                <li><a href="../classes/Preview.html">Preview</a></li>
                                <li><a href="../classes/Project.html">Project</a></li>
                                <li><a href="../classes/RenderElements.html">RenderElements</a></li>
                                <li><a href="../classes/SimpleHtml.html">SimpleHtml</a></li>
                                <li><a href="../classes/Span.html">Span</a></li>
                                <li><a href="../classes/Tree.html">Tree</a></li>
                                <li><a href="../classes/Tree.initModalAndEvents.html">Tree.initModalAndEvents</a></li>
                                <li><a href="../classes/UIEvents.html">UIEvents</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: render-elements.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Classe responsável pelos métodos de renderização da aplicação (exibição dos elemento concreto, TreeView, Código gerado)
 *
 * @class RenderElements
 * @constructor
 */
var RenderElements = function(){
    &quot;use strict&quot;;
    var panelBase;

    /**
     * Método responsável por renderizar os elementos concretos no protótipo.
     * @method _renderConcreteInterface
     * @param {Object} node Elemento abstrato. 
     * @param {jQuery} root Elemento jQuery onde serão inseridos novos elementos concretos.
     * @return O protótipo com os elementos.
     */
    var _renderConcreteInterface = function(node, root) {
        if(!root) {
            var item = concreteInterfaceObj.findItem(node);
            if(item.id == undefined) item = new Div(node);
            
            item.typeElement = item.typeElement ? item.typeElement : &quot;div&quot;;
            item.html = item.html &amp;&amp; item.html.jquery ? item.html.clone() : item.getTemplate(item.typeElement);
            item.name = node.text;
            item.bind = node.bind ? node.bind : undefined;
            
            concreteInterfaceObj.replaceItem(item);
            
            root = $(_.template(panelBase)({item:item})); //insere o elemento dentro do panel base
        }

        var length = node.nodes ? node.nodes.length : 0;
        for(var i=0; i &lt; length; i++) {
            var itemNode = concreteInterfaceObj.findItem(node.nodes[i]);
            if(itemNode.id == undefined) itemNode = new Div(node.nodes[i]);
            
            itemNode.typeElement = itemNode.typeElement ? itemNode.typeElement : &quot;div&quot;;
            itemNode.html = itemNode.html &amp;&amp; itemNode.html.jquery ? itemNode.html.clone() : itemNode.getTemplate(itemNode.typeElement);
            itemNode.name = node.nodes[i].text;
            itemNode.bind = node.nodes[i].bind ? node.nodes[i].bind : undefined;
            
            concreteInterfaceObj.replaceItem(itemNode);

            var child = $(_.template(panelBase)({item:itemNode})); //insere o elemento dentro do panel base
            if(node.nodes[i].nodes) child = _renderConcreteInterface(node.nodes[i], child);

            root.find(&#x27;.panel-body&#x27;).first().append(child);
        }

        return root;
    };

    /**
     * Evento disparado quando há a mudança do elemento concreto no combobox. A partir do novo elemento selecionado, é buscado o template correspondente
     * e feita a atualização do elemento concreto.
     *
     * @event ChangeSelectType
     */
    $(document).on(&#x27;change&#x27;, &#x27;.select-type-element&#x27;, function(e){
        var value = $(this).val();
        var root = $(this).parent().parent().parent().parent();
        var id = root.data(&#x27;id&#x27;);
        var node = globalTree.findNodeById(id);
        var item = concreteInterfaceObj.findItem(node);

        switch(value){
            case &#x27;div&#x27; : item = new Div(node); break;
            case &#x27;p&#x27; : item = new Paragraph(node); break;
            case &#x27;header&#x27; : item = new Header(node); break;
            case &#x27;a&#x27; : item = new Link(node); break;
            case &#x27;label&#x27; : item = new Label(node); break;
            case &#x27;span&#x27; : item = new Span(node); break;
            case &#x27;list&#x27; : item = new List(node); break;
            case &#x27;list-item&#x27; : item = new ListItem(node); break;
            case &#x27;image&#x27; : item = new ImageHtml(node); break;
            case &#x27;carousel&#x27; : item = new Carousel(node); break;
            case &#x27;carousel-item&#x27; : item = new CarouselItem(node); break;
            case &#x27;navigation&#x27; : item = new BootstrapNavigation(node); break;
            case &#x27;navigation-list&#x27; : item = new BootstrapNavigationList(node); break;
            case &#x27;navigation-list-item&#x27; : item = new BootstrapNavigationListItem(node); break;
            case &#x27;div&#x27; : item = new Div(node); break;
            case &#x27;form&#x27; : item = new Formulario(node); break;
            case &#x27;input-text&#x27; : item = new InputText(node); break;
            case &#x27;input-textarea&#x27; : item = new InputTextarea(node); break;
            case &#x27;input-radio&#x27; : item = new InputRadioCheck(node); break;
            case &#x27;input-select&#x27; : item = new InputSelect(node); break;
            case &#x27;input-option&#x27; : item = new InputOption(node); break;
            case &#x27;input-button&#x27; : item = new Button(node); break;
        }

        item.componentWidth = root.width() + &#x27;px&#x27;;
        concreteInterfaceObj.replaceItem(item);
        Code.showConcreteInterfaceCode();
        
        $(&#x27;#tree&#x27;).trigger(&#x27;treeRender&#x27;, $.extend({}, true, globalTree));
    });

    return {
        /**
         * Método responsável por obter o template base dos elementos.
         * @method initRenderElements
         * @static
         */
        initRenderElements: function() {
            panelBase = $(&#x27;#panel-base&#x27;).html();
        },

        /**
         * Método responsável por definir as ações do botão para a raiz da TreeView (Não existe tal funcionalidade no plugin)
         * @method commandsRootTree
         * @static
         */
        commandsRootTree: function() {
            $(&quot;#btn-root-add&quot;).click(function(e) {
                //cria um novo objeto
                var newItem = new Object();
                newItem.text = &quot;Novo Item&quot;;
                newItem.state = new Object();
                newItem.state.added = true;
                newItem.state.disabled = true;
                newItem.nodeId = globalTree.nodes.length;
                newItem.id = globalTree.setId();
                newItem.selectable = false;
                
                
                //insere como filho do nó corrente
                globalTree.tree.push(newItem);

                //insere a fila de nós
                globalTree.nodes.push(newItem);

                $(&#x27;#tree&#x27;).treeview(&#x27;addElement&#x27;, [ newItem , { silent: true } ]);

                globalTree.$element.empty().append(globalTree.$wrapper.empty());
                globalTree.buildTree(globalTree.tree, 0);
                globalTree.$element.trigger(&#x27;treeRender&#x27;, $.extend(true, {}, globalTree));
            });

            $(&quot;#btn-root-removeall&quot;).click(function(e){
                var ids = [];
                for(var i=0; i&lt;globalTree.tree.length; i++){
                    if(globalTree.tree[i].state.checked) ids.push(globalTree.tree[i].nodeId);
                }

                globalTree.removeNodes(globalTree.tree, ids);
                
                $(&quot;#tree&quot;).treeview(&#x27;removeElements&#x27;, [ ids , { silent: true } ]);
                
                globalTree.$element.empty().append(globalTree.$wrapper.empty());
                globalTree.buildTree(globalTree.tree, 0);
                globalTree.$element.trigger(&#x27;treeRender&#x27;, $.extend(true, {}, globalTree));
            })
        },

        /**
         * Método responsável por renderizar a TreeView e a partir disso atualizar toda a aplicação.
         * @method renderTree
         * @param {Object} data Instancia do plugin BootstrapTreeView.
         * @static
         */
        var renderTree = function(data){
            var listItens = [];
            globalTree = data;

            concreteInterfaceObj.cleanConcreteInterface();
            
            $(&quot;#prototype&quot;).empty();
            for(var i=0; i&lt;data.tree.length; i++){
                $(&quot;#prototype&quot;).append(_renderConcreteInterface(data.tree[i]));
            }

            showAbstractInterfaceCode(data);
            showConcreteInterfaceCode();
            /*
            $(&#x27;#abstract-code pre&#x27;).html(
                cleanString(abstractInterfaceObj.generateAbstractInterface(data.abstractInterface))
            );

            $(&#x27;#concrete-code pre&#x27;).html(
                cleanString(concreteInterfaceObj.generateConcreteInterface())
            );*/
            
            UIEvents.resizeBox();
            UIEvents.setDraggable();

            $(&#x27;.carousel&#x27;).carousel();
            Project.saveWebStorage();
        }
    }
}();
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
